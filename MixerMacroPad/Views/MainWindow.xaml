<Window x:Class="MixerMacroPad.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MixerMacroPad.Views"
        xmlns:viewModels="clr-namespace:MixerMacroPad.ViewModels"
        mc:Ignorable="d"
        Title="Mixer Macro Pad" Height="900" Width="1200" Background="#0f0f0f">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <StackPanel Orientation="Horizontal" Margin="0 0 0 12" HorizontalAlignment="Stretch">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="COM" Margin="0 0 8 0" VerticalAlignment="Center" />
                <ComboBox Width="120" ItemsSource="{Binding ComPorts}" SelectedItem="{Binding SelectedComPort, Mode=TwoWay}" />
                <Button Content="Refresh" Click="RefreshPorts_Click" />
                <Button Content="Connect" Click="Connect_Click" />
                <Button Content="Disconnect" Click="Disconnect_Click" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="32 0 0 0" VerticalAlignment="Center">
                <CheckBox Content="Invert buttons" IsChecked="{Binding InvertButtons}" />
                <Button Content="Save config" Click="SaveConfig_Click" />
                <Button Content="Export" Click="Export_Click" />
                <Button Content="Import" Click="Import_Click" />
            </StackPanel>
        </StackPanel>
        <TabControl Grid.Row="1">
            <TabItem Header="Mixers">
                <ItemsControl ItemsSource="{Binding Sliders}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="#181818" Padding="12" Margin="4" CornerRadius="6">
                                <StackPanel>
                                    <TextBlock Text="Slider" FontWeight="Bold" />
                                    <StackPanel Orientation="Horizontal">
                                        <ComboBox Width="180" ItemsSource="{Binding DataContext.Sessions, RelativeSource={RelativeSource AncestorType=ItemsControl}}" DisplayMemberPath="DisplayName" SelectedValuePath="Id" SelectedValue="{Binding TargetId, Mode=TwoWay}" />
                                        <ComboBox Width="120" SelectedValue="{Binding TargetType, Mode=TwoWay}" >
                                            <ComboBoxItem Content="Master" Tag="Master" />
                                            <ComboBoxItem Content="Process" Tag="Process" />
                                            <ComboBoxItem Content="DeviceSession" Tag="DeviceSession" />
                                        </ComboBox>
                                        <CheckBox Content="Invert" IsChecked="{Binding Invert}" />
                                        <Button Content="Refresh sessions" Click="RefreshSessions_Click" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Delta" />
                                        <TextBox Width="60" Text="{Binding DeltaThreshold, Mode=TwoWay}" />
                                        <TextBlock Text="Smoothing (ms)" Margin="12 0 0 0" />
                                        <TextBox Width="60" Text="{Binding SmoothingMs, Mode=TwoWay}" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </TabItem>
            <TabItem Header="Buttons">
                <ItemsControl ItemsSource="{Binding Buttons}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="#181818" Padding="12" Margin="4" CornerRadius="6">
                                <StackPanel>
                                    <TextBlock Text="Button" FontWeight="Bold" />
                                    <StackPanel Orientation="Horizontal">
                                        <ComboBox Width="160" SelectedValue="{Binding ActionType, Mode=TwoWay}" />
                                        <ComboBox Width="120" SelectedValue="{Binding Mode, Mode=TwoWay}" />
                                        <TextBox Width="180" Text="{Binding Payload, Mode=TwoWay}" />
                                        <TextBox Width="120" Text="{Binding Arguments, Mode=TwoWay}" />
                                        <CheckBox Content="Run as admin" IsChecked="{Binding RunAsAdmin}" />
                                        <TextBlock Text="Repeat (ms)" Margin="8 0 0 0" />
                                        <TextBox Width="60" Text="{Binding RepeatIntervalMs, Mode=TwoWay}" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </TabItem>
            <TabItem Header="Diagnose">
                <StackPanel>
                    <TextBlock Text="Raw line" />
                    <TextBox Text="{Binding RawLine}" IsReadOnly="True" Height="30" />
                    <TextBlock Text="Logs" />
                    <TextBox Text="{Binding Log}" AcceptsReturn="True" Height="200" VerticalScrollBarVisibility="Auto" />
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
